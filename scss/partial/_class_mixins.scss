//////////////////////// INTERACTIVITY
@mixin not-selectable {
	-webkit-touch-callout: none;
	-webkit-user-select  : none;
	-khtml-user-select   : none;
	-moz-user-select     : none;
	-ms-user-select      : none;
	user-select          : none;
}

@mixin selectable {
	-webkit-touch-callout: default;
	-webkit-user-select  : text;
	-khtml-user-select   : text;
	-moz-user-select     : text;
	-ms-user-select      : text;
	user-select          : text;
}

@function get-hoverable-class-name( $hoverable-id ) {
	@return "#{ $class-hoverable }-#{ $hoverable-id }";
}

@mixin hoverable( $hoverable-id: false ) {
	$actual-hovered-class    : if( $hoverable-id == false, $class-hovered,     #{ $class-hovered     }-#{ $hoverable-id } );
	$actual-not-hovered-class: if( $hoverable-id == false, $class-not-hovered, #{ $class-not-hovered }-#{ $hoverable-id } );

	.#{ $actual-hovered-class }, .#{ $actual-not-hovered-class } {
		@extend .#{ $class-transitions };
	}
	.#{ $actual-hovered-class } {
		@extend .#{ $class-transparent };
	}
	@include when-hovered {
		.#{ $actual-hovered-class } {
			@extend .#{ $class-opaque };
		}
		.#{ $actual-not-hovered-class } {
			@extend .#{ $class-transparent };
		}
	}
}

@mixin loaded {
	@extend .#{ $class-transitions };
	&.#{ $class-not } {
		@extend .#{ $class-transparent };
	}
	@extend .#{ $class-opaque };
}

//////////////////////// BLOCKS
@mixin transparent {
	@include opacity( 0 );
}

@mixin mostly-transparent {
	@include opacity( $default-mostly );
}

@mixin barely-transparent {
	@include opacity( $default-barely );
}

@mixin opaque {
	@include opacity( 1 );
}

@mixin mostly-opaque {
	@include opacity( 1 - $default-mostly );
}

@mixin barely-opaque {
	@include opacity( 1 - $default-barely );
}

@mixin shaded {
	background-color: rgba( black, 1 - $default-barely );
}

@mixin tinted {
	background-color: rgba( white, 1 - $default-barely );
}

@mixin gone {
	display: none !important;
}

@mixin invisible {
	visibility: hidden;
}

@mixin inline {
	display: inline;
}

@mixin block {
	display: block;
}

@mixin no-overflow {
	overflow: hidden;
}
@mixin show-overflow {
	overflow: visible;
}
@mixin overflow-scroll {
	overflow: auto;
	-webkit-overflow-scrolling: touch;
}
@mixin overflow-ellipsis {
	@include no-overflow();
	text-overflow: ellipsis;
}

// Block floating
@mixin left {
	float: left;
}
@mixin right {
	float: right;
}

@mixin clear-left {
	clear: left;
}
@mixin clear-right {
	clear: right;
}
@mixin clear {
	clear: both;
}

//////////////////////// TEXT
@mixin link {
	&, * {
		text-decoration: none;
		cursor: pointer;
		@include when-disabled {
			@include normal-cursor;
		}
	}
}
@mixin normal-cursor {
	cursor: default;
}

// Fonts
@mixin sans-serif {
	font-family: $sans-serif-font-family;
}

@mixin serif {
	font-family: $sans-serif-font-family;
}

// Text Alignment
@mixin text-left {
	text-align: left;
}
@mixin text-right {
	text-align: right;
}
@mixin text-center {
	text-align: center;
}
@mixin text-justify {
	text-align: justify;
}

@mixin uppercase {
	text-transform: uppercase;
}

@mixin capitalize {
	text-transform: capitalize;
}

@mixin nowrap {
	white-space: nowrap;
}

@mixin wrap {
	white-space: normal;
}

@mixin small {
	font-size: $small;
	// line-height: $small;
}

@mixin very-small {
	font-size: $very-small;
	// line-height: $very-small;
}

@mixin light {
	font-weight: 300;
}

@mixin normal {
	font-weight: normal;
}

@mixin b {
	&, & td, & .#{ $class-table-cell }, &:before, &:after {
		font-weight: bold;
	}
}

@mixin em {
	&, & td, & .#{ $class-table-cell }, &:before, &:after {
		font-style: italic;
	}
}

@mixin i {
	@include em();
}

@mixin u {
	&, & td, & .#{ $class-table-cell }, &:before, &:after {
		text-decoration: underline;
	}
}

@mixin less-wide {
	letter-spacing: .2em;
}

@mixin wide {
	letter-spacing: .33em;
}

@mixin very-wide {
	letter-spacing: .5em;
}

@mixin extra-wide {
	letter-spacing: 1em;
}

$hanging-indent: 2.6em;
@mixin hanging-indent {
	@include block;
	padding-left: $hanging-indent;
	text-indent: -$hanging-indent;
}

//////////////////////// TABLES
@mixin table {
	display        : table;
	border-collapse: collapse;
	border-spacing : 0em;

	&.#{ $class-fixed-layout } {
		table-layout: fixed;
	}
	&.#{ $class-auto-layout } {
		table-layout: auto;
	}
}

@mixin table-row {
	display: table-row;
}

@mixin table-cell {
	display: table-cell;
}

@mixin valign-center {
	vertical-align: middle;
}
@mixin valign-bottom {
	vertical-align: bottom;
}
@mixin valign-top {
	vertical-align: top;
}

@mixin table-padded( $theme: $current-theme ) {
	@if has-spacing() {
		border-collapse: separate;
		border-spacing: get-standard-padding( $theme: $theme );
		&.#{ $class-less } {
			border-spacing: get-less-padding( $theme: $theme );
		}
		&.#{ $class-more } {
			border-spacing: get-more-padding( $theme: $theme );
		}
	}
}

//////////////////////// POSITIONING
@mixin relative {
	position: relative;
}
@mixin absolute {
	position: absolute;
}
@mixin fixed {
	position: fixed;
}

@mixin above {
	z-index: 99;
}

@mixin way-above {
	z-index: 999;
}

@mixin way-way-above {
	z-index: 9999;
}

@mixin below {
	z-index: 0;
}

@mixin top()    { top:    0px; }
@mixin bottom { bottom: 0px; }

@mixin tl { top:    0px; left:  0px; }
@mixin tr { top:    0px; right: 0px; }
@mixin br { bottom: 0px; right: 0px; }
@mixin bl { bottom: 0px; left:  0px; }

//////////////////////// CONTENT STYLING
@mixin appearance-none {
	@include appearance( none );
}

@mixin hardware-render {
	@include translate( 0, 0, 0 );
}

@mixin transitions {
	@include transition-property( all );
	@include transition-duration( $default-transition-duration );

	&.#{ $class-fast } {
		@include transition-duration( $default-transition-duration / 2 );
	}
	&.#{ $class-slow } {
		@include transition-duration( $default-transition-duration * 2 );
	}
}

@mixin no-transitions {
	&, * {
		@include transition-property( none !important );
		@include transition-duration( 0s !important );
	}
}

//////////////////////// SIZING
@mixin whole-width {
	width: 100%;
	&.underestimated { 
		width: 100% - $default-underestimation;
	}
}
@mixin whole-height {
	height: 100%;
	&.underestimated { 
		height: 100% - $default-underestimation;
	}
}
@mixin whole-max-width {
	max-width: 100%;
	&.underestimated { 
		max-width: 100% - $default-underestimation;
	}
}
@mixin whole-max-height {
	max-height: 100%;
	&.underestimated { 
		max-height: 100% - $default-underestimation;
	}
}
@mixin whole-min-width {
	min-width: 100%;
	&.underestimated { 
		min-width: 100% - $default-underestimation;
	}
}
@mixin whole-min-height {
	min-height: 100%;
	&.underestimated { 
		min-height: 100% - $default-underestimation;
	}
}

@function get-ratio-class-name( $property, $numerator, $denominator ) {
	@return "#{ $property }-#{ $class-ratio }-#{ $numerator }-#{ $denominator }";
}

@mixin ratio( $property, $numerator, $denominator, $underestimation: $default-underestimation ) {
	#{ $property }: $numerator / $denominator * 100%;
	&.underestimated { 
		#{ $property }: $numerator / $denominator * 100% - $underestimation;
	}
}

@mixin border-box {
	@include box-sizing( border-box );
}

@mixin no-border {
	border: none !important;
	// border-top   : 0px solid transparent;
	// border-right : 0px solid transparent;
	// border-bottom: 0px solid transparent;
	// border-left  : 0px solid transparent;
}

@mixin transparent-border {
	border-color: transparent !important;
}

@mixin no-padding {
	padding: 0px !important;
	// padding-top   : 0px;
	// padding-right : 0px;
	// padding-bottom: 0px;
	// padding-left  : 0px;
}

@mixin no-margin {
	margin: 0px !important;
	// margin-top   : 0px;
	// margin-right : 0px;
	// margin-bottom: 0px;
	// margin-left  : 0px;
}
@mixin lr-auto-margin {
	margin-left: auto;
	margin-right: auto;
}

@mixin whole-rounded {
	@include border-radius( 100% );
}

@mixin no-rounding {
	@include border-radius( 0% );
}

////////////////////////////////////////////
//////////////////////// PLAIN-THEMED MIXINS
////////////////////////////////////////////

//////////////////////// ROUNDED BORDERS
@mixin rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin t-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-top-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin r-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-right-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin b-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-bottom-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin l-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-left-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin tl-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-top-left-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin tr-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-top-right-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin bl-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-bottom-left-radius( get-border-radius( $theme: $theme ) );
	}
}

@mixin br-rounded( $theme: $current-theme ) {
	@if has-border() {
		@include border-bottom-right-radius( get-border-radius( $theme: $theme ) );
	}
}

//////////////////////// PADDING/MARGIN
@mixin padded( $theme: $current-theme ) { 
	@if has-spacing() {
		padding: get-standard-padding( $theme: $theme );
		&.#{ $class-less } {
			&, &:before {
				padding: get-less-padding( $theme: $theme );
			}
		}
		&.#{ $class-more } {
			&, &:before {
				padding: get-more-padding( $theme: $theme );
			}
		}
	}
}
@mixin t-padded( $theme: $current-theme ) { 
	@if has-spacing() {
		padding-top: get-standard-padding( $theme: $theme );
		&.#{ $class-less } {
			padding-top: get-less-padding( $theme: $theme );
		}
		&.#{ $class-more } {
			padding-top: get-more-padding( $theme: $theme );
		}
	}
}
@mixin r-padded( $theme: $current-theme ) { 
	@if has-spacing() {
		padding-right: get-standard-padding( $theme: $theme );
		&.#{ $class-less } {
			padding-right: get-less-padding( $theme: $theme );
		}
		&.#{ $class-more } {
			padding-right: get-more-padding( $theme: $theme );
		}
	}
}
@mixin b-padded( $theme: $current-theme ) { 
	@if has-spacing() {
		padding-bottom: get-standard-padding( $theme: $theme );
		&.#{ $class-less } {
			padding-bottom: get-less-padding( $theme: $theme );
		}
		&.#{ $class-more } {
			padding-bottom: get-more-padding( $theme: $theme );
		}
	}
}
@mixin l-padded( $theme: $current-theme ) { 
	@if has-spacing() {
		padding-left: get-standard-padding( $theme: $theme );
		&.#{ $class-less } {
			padding-left: get-less-padding( $theme: $theme );
		}
		&.#{ $class-more } {
			padding-left: get-more-padding( $theme: $theme );
		}
	}
}
@mixin lr-padded {
	@include l-padded;
	@include r-padded;
}
@mixin tb-padded {
	@include t-padded;
	@include b-padded;
}

@mixin margin( $theme: $current-theme ) { 
	@if has-spacing() {
		margin: get-standard-margin( $theme: $theme );
		&.#{ $class-less } {
			margin: get-less-margin( $theme: $theme );
		}
		&.#{ $class-more } {
			margin: get-more-margin( $theme: $theme );
		}
	}
}
@mixin t-margin( $theme: $current-theme ) { 
	@if has-spacing() {
		margin-top: get-standard-margin( $theme: $theme );
		&.#{ $class-less } {
			margin-top: get-less-margin( $theme: $theme );
		}
		&.#{ $class-more } {
			margin-top: get-more-margin( $theme: $theme );
		}
	}
}
@mixin r-margin( $theme: $current-theme ) { 
	@if has-spacing() {
		margin-right: get-standard-margin( $theme: $theme );
		&.#{ $class-less } {
			margin-right: get-less-margin( $theme: $theme );
		}
		&.#{ $class-more } {
			margin-right: get-more-margin( $theme: $theme );
		}
	}
}
@mixin b-margin( $theme: $current-theme ) { 
	@if has-spacing() {
		margin-bottom: get-standard-margin( $theme: $theme );
		&.#{ $class-less } {
			margin-bottom: get-less-margin( $theme: $theme );
		}
		&.#{ $class-more } {
			margin-bottom: get-more-margin( $theme: $theme );
		}
	}
}
@mixin l-margin( $theme: $current-theme ) { 
	@if has-spacing() {
		margin-left: get-standard-margin( $theme: $theme );
		&.#{ $class-less } {
			margin-left: get-less-margin( $theme: $theme );
		}
		&.#{ $class-more } {
			margin-left: get-more-margin( $theme: $theme );
		}
	}
}
@mixin lr-margin {
	@include l-margin;
	@include r-margin;
}
@mixin tb-margin {
	@include t-margin;
	@include b-margin;
}

//////////////////////// SHADOWS
@mixin shadow( 
	$theme               : $current-theme, 
	$external            : true, // This means the primary shadow is an outer shadow, and the high/lowlights are inner shadows.
	$include-highlight   : false,
	$include-lowlight    : false,
	$primary-depth-factor: 1,
	$spread              : 2.5,
	$shift               : 1
) { 
	@if has-shadow( $theme: $theme ) {
		$shadow-color: get-shadow-color( $theme: $theme );

		$highlight-color: white; //if( $inverse,                      black,                       white );
		$lowlight-color : shade( $shadow-color, 75% ); //if( $inverse, tint( $shadow-color, 75% ), shade( $shadow-color, 75% ) );

		$primary-shadow     : '';
		$primary-shadow-ff  : '';
		$highlight-shadow   : '';
		$highlight-shadow-ff: '';
		$lowlight-shadow    : '';
		$lowlight-shadow-ff : '';

		$highlight-visibility-factor: if( $include-highlight, 1, 0 );
		$lowlight-visibility-factor : if( $include-lowlight,  1, 0 );

		$primary-depth  : get-shadow-primary-depth() * $primary-depth-factor;
		$secondary-depth: get-shadow-secondary-depth();

		$ff-factor: .5;

		$opacity: get-shadow-opacity();

		@if $external != false {
			//                                                                                                                                              -------------------NO INSET SHADOW-------------------
			$primary-shadow   : 0px ( $primary-depth * $shift              ) ( $primary-depth * $spread              ) 0px rgba( $shadow-color, $opacity ), 0px 0px 0px 0px rgba( $shadow-color, $opacity ) inset;
			$primary-shadow-ff: 0px ( $primary-depth * $shift * $ff-factor ) ( $primary-depth * $spread * $ff-factor ) 0px rgba( $shadow-color, $opacity ), 0px 0px 0px 0px rgba( $shadow-color, $opacity ) inset;

			//                    -------------------------------NO EXTERNAL SHADOW-------------------------------
			$highlight-shadow   : 0px 0px 0px 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ), 0px (   $secondary-depth * $shift              ) ( $secondary-depth * $spread              ) 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ) inset;
			$highlight-shadow-ff: 0px 0px 0px 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ), 0px (   $secondary-depth * $shift * $ff-factor ) ( $secondary-depth * $spread * $ff-factor ) 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ) inset;
			$lowlight-shadow    : 0px 0px 0px 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ), 0px ( - $secondary-depth * $shift              ) ( $secondary-depth * $spread              ) 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ) inset;
			$lowlight-shadow-ff : 0px 0px 0px 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ), 0px ( - $secondary-depth * $shift * $ff-factor ) ( $secondary-depth * $spread * $ff-factor ) 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ) inset;
		}
		@else {
			//                  --------------NO EXTERNAL SHADOW--------------
			$primary-shadow   : 0px 0px 0px 0px rgba( $shadow-color, $opacity ), 0px ( $primary-depth * $shift              ) ( $primary-depth * $spread              ) 0px rgba( $shadow-color, $opacity ) inset;
			$primary-shadow-ff: 0px 0px 0px 0px rgba( $shadow-color, $opacity ), 0px ( $primary-depth * $shift * $ff-factor ) ( $primary-depth * $spread * $ff-factor ) 0px rgba( $shadow-color, $opacity ) inset;

			//                                                                                                                                                                                        ------------------------------------NO INSET SHADOW------------------------------------
			$highlight-shadow   : 0px (   $secondary-depth * $shift              ) ( $secondary-depth * $spread              ) 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ), 0px 0px 0px 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ) inset;
			$highlight-shadow-ff: 0px (   $secondary-depth * $shift * $ff-factor ) ( $secondary-depth * $spread * $ff-factor ) 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ), 0px 0px 0px 0px rgba( $highlight-color, $opacity * $highlight-visibility-factor ) inset;
			$lowlight-shadow    : 0px ( - $secondary-depth * $shift              ) ( $secondary-depth * $spread              ) 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ), 0px 0px 0px 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ) inset;
			$lowlight-shadow-ff : 0px ( - $secondary-depth * $shift * $ff-factor ) ( $secondary-depth * $spread * $ff-factor ) 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ), 0px 0px 0px 0px rgba( $lowlight-color,  $opacity *  $lowlight-visibility-factor ) inset;
		}

		$all-shadows   : $primary-shadow   , $highlight-shadow   , $lowlight-shadow   ;
		$all-shadows-ff: $primary-shadow-ff, $highlight-shadow-ff, $lowlight-shadow-ff;

		@include box-shadow( $all-shadows );
		.ff & {
			@include box-shadow( $all-shadows-ff );
		}
	}
}

@mixin no-shadow( $theme: $current-theme ) {
	@include shadow(
		$theme : $current-theme,
		$spread: 0,
		$shift : 0
	);
}

@mixin inset-shadow( 
	$theme               : $current-theme,
	$primary-depth-factor: 1
) {
	@include shadow( 
		$theme               : $theme, 
		$external            : false,
		$primary-depth-factor: $primary-depth-factor
	);
}

@mixin deep-shadow( 
	$theme               : $current-theme,
	$primary-depth-factor: 2
) {
	@include shadow( 
		$theme               : $theme, 
		$primary-depth-factor: $primary-depth-factor
	);
}

@mixin deep-inset-shadow( 
	$theme               : $current-theme,
	$primary-depth-factor: 2
) {
	@include shadow( 
		$theme               : $theme, 
		$external            : false,
		$primary-depth-factor: $primary-depth-factor
	);
}

@mixin button-shadow( 
	$theme    : $current-theme,
	$depressed: false,
	$hovered  : false,
	$disabled : false
) {
	@include shadow( 
		$theme               : $theme, 
		// $inverse             : $inverse,
		$include-lowlight    : true,
		$include-highlight   : not $depressed,
		$external            : not $depressed,
		$primary-depth-factor: if( $hovered, 1.5, if( $disabled, 0, .5 ) )
	);
}

@mixin text-shadowed(
	$theme: $current-theme
) {
	@if has-shadow( $theme: $theme ) {
		$shadow-color: get-shadow-color( $theme: $theme );

		$secondary-depth: get-shadow-secondary-depth( $theme: $theme );

		$opacity: get-shadow-opacity( $theme: $theme );

		$spread: 2.5;
		$shift : 1;

		@include text-shadow( 0px ( $secondary-depth * $shift ) ( $secondary-depth * $spread ) rgba( $shadow-color, $opacity ) )
	}
}

/////////////////////////////////////////////////////////////
//////////////////////// INVERSABLE & SECONDARY-THEMED MIXINS
/////////////////////////////////////////////////////////////

//////////////////////// BORDERS
@mixin border-base( 
	$theme           : $current-theme,
	$inverse         : $current-inverse,
	$secondary       : $current-secondary,
	$width-properties: ( 'border-width' ),
	$heavy           : false
) {
	@if has-border( $theme: $theme ) and ( ( has-primary( $theme: $theme ) and not $secondary ) or has-secondary( $theme: $theme ) ) {
		$color: get-foreground-color( $theme: $theme, $secondary: $secondary, $inverse: $inverse );

		$border-opacity: get-border-opacity();
		$border-width: get-border-width( $theme: $theme );
		$border-thick-factor: get-border-thick-factor( $theme: $theme );

		&, &:before {
			border-color: rgba( $color, if( $heavy, get-border-heavy-opacity-factor(), 1 ) * $border-opacity );

			border-style: get-border-style( $theme: $theme );

			@each $width-property in $width-properties {
				#{ $width-property }: $border-width;
			}
		}

		&.#{ $class-alternate } {
			&, &:before {
				$color: get-foreground-color( $theme: $theme, $secondary: not $secondary, $inverse: $inverse );

				border-color: rgba( $color, if( $heavy, get-border-heavy-opacity-factor(), 1 ) * $border-opacity );
			}
		}

		&.#{ $class-thick } {
			&, &:before {
				@each $width-property in $width-properties {
					#{ $width-property }: $border-width * $border-thick-factor;
				}
			}
		}

		&.#{ $class-dotted } {
			&, &:before {
				border-style: dotted;
			}
		}
	}
}
@mixin bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $heavy: true );
		}
	}
}
@mixin t-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-top-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-top-width' ), $heavy: true );
		}
	}
}
@mixin r-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-right-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-right-width' ), $heavy: true );
		}
	}
}
@mixin b-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-bottom-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-bottom-width' ), $heavy: true );
		}
	}
}
@mixin l-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width' ), $heavy: true );
		}
	}
}
@mixin lr-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width', 'border-right-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width', 'border-right-width' ), $heavy: true );
		}
	}
}
@mixin tb-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-top-width', 'border-bottom-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-top-width', 'border-bottom-width' ), $heavy: true );
		}
	}
}
@mixin ltr-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width', 'border-top-width', 'border-right-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width', 'border-top-width', 'border-right-width' ), $heavy: true );
		}
	}
}
@mixin lbr-bordered( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width', 'border-bottom-width', 'border-right-width' ), $heavy: false );
		&.#{ $class-heavy } {
			@include border-base( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $width-properties: ( 'border-left-width', 'border-bottom-width', 'border-right-width' ), $heavy: true );
		}
	}
}

@mixin spinner( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@if has-border( $theme: $theme ) {
		@include t-bordered( $theme: $theme, $inverse: $inverse, $secondary: $secondary );

		&, &:before {
			border-left  : 0px;
			border-right : 0px;
			border-bottom: 0px;

			@include border-box;
			@include whole-rounded;
			@include inline-block;

			@include transitions;

			padding: .5em;
		}
		&.#{ $class-big } {
			&, &:before {
				padding: 1em;
			}
		}

		@include relative;
		@include my-animation( $name: $class-spin, $timing-function: linear, $iteration-count: infinite, $duration: 1s );

		$border-width: get-border-width( $theme: $theme );

		&:before {
			content: '';

			@include absolute;

			top : -$border-width;
			left: 0px;

			@include my-animation( $name: $class-spin, $timing-function: ease, $iteration-count: infinite, $duration: 2s );
		}

		&.#{ $class-thick } {
			&:before {
				top : -$border-width * get-border-thick-factor( $theme: $theme );
			}

			> * {
				top : -$border-width * get-border-thick-factor( $theme: $theme );	
			}
		}

		> * {
			@include block;
			@include absolute;
			@include whole-width;
			@include whole-height;

			top : -$border-width;
			left: 0px;

			@include my-animation( $name: $class-spin, $timing-function: ease, $iteration-count: infinite, $duration: 1s, $direction: alternate );
		}
	}
}

//////////////////////// INPUTS
@mixin text-input( 
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@include border-box;
	margin: 0px;

	@extend .#{ $class-transitions } !optional;
	@include when-just-touching {
		@extend .#{ $class-transitions }.#{ $class-fast } !optional;
	}

	@include coloring(     $theme: $theme, $inverse: $inverse, $secondary: $secondary );
	@include bordered(     $theme: $theme, $inverse: $inverse, $secondary: $secondary );
	@include inset-shadow( $theme: $theme, $primary-depth-factor: 0 );

	padding-left : get-less-padding( $theme: $theme );
	padding-right: get-less-padding( $theme: $theme );

	@include when-at {
		@include transparent-border;
		@include inset-shadow( $theme: $theme );
	}
	@include when-disabled {
		@include whenever {
			@include bordered(     $theme: $theme, $inverse: $inverse, $secondary: $secondary );
			@include inset-shadow( $theme: $theme, $primary-depth-factor: 0 );
		}
	}
}

@mixin select(
	$theme    : $current-theme,
	$inverse  : $current-inverse,
	$secondary: $current-secondary
) {
	@include appearance-none;
	@include border-box;
	// margin: 0px;
	
	@extend .#{ $class-transitions } !optional;
	@include when-just-touching {
		@extend .#{ $class-transitions }.#{ $class-fast } !optional;
	}

	@include coloring( $theme: $theme, $inverse: $inverse, $secondary: $secondary );
	@include bordered( $theme: $theme, $inverse: $inverse, $secondary: $secondary );
	@include shadow(   $theme: $theme, $primary-depth-factor: 0 );

	padding-left  : get-less-padding( $theme: $theme );

	.not-ff.not-ie & {
		padding-right: 16px / $base-font-size * 1em; // the width of the arrow image

		$foreground-color: contrast-color( 
			get-color( $theme: $theme, $inverse: $inverse, $secondary: $secondary ), 
			black, 
			white,
			50%
		);

		@if white == $foreground-color {
			background-image: url( '../img/arrow_down_white.svg' );
		}
		@else {
			background-image: url( '../img/arrow_down.svg' );
		}
		background-position: right center;
		background-repeat: no-repeat;
		background-size: auto 50%;
	}

	@include when-at {
		@include transparent-border;
		@include shadow(   $theme: $theme );
	}
	@include when-disabled {
		@include whenever {
			@include bordered( $theme: $theme, $inverse: $inverse, $secondary: $secondary );
			@include shadow(   $theme: $theme, $primary-depth-factor: 0 );
		}
	}
}

//////////////////////// BUTTONS/COLORS
@mixin sheer( 
	$theme    : $current-theme, 
	$inverse  : $current-inverse, 
	$secondary: $current-secondary 
) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$background-color: get-foreground-color( $theme: $theme, $secondary: $secondary, $inverse: $inverse );
		background-color: rgba( $background-color, 1 - $default-barely );

		&.#{ $class-mostly } {
			background-color: rgba( $background-color, $default-mostly );
		}
		
	}
}

@mixin coloring( 
	$theme    : $current-theme, 
	$inverse  : $current-inverse, 
	$secondary: $current-secondary 
) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$background-color: get-color( $theme: $theme, $inverse: $inverse, $secondary: $secondary );

		$darker-background-color: shade( $background-color, get-darkening( $theme: $theme, $secondary: $secondary ) );

		$much-darker-background-color: shade( $background-color, ( 100% - get-darkening( $theme: $theme, $secondary: $secondary ) ) / 2 );

		$lighter-background-color: tint( $background-color, get-lightening( $theme: $theme, $secondary: $secondary ) );

		$much-lighter-background-color: tint( $background-color, ( 100% - get-lightening( $theme: $theme, $secondary: $secondary ) ) / 2 );

		$desaturated-background-color: desaturate( $background-color, $default-desaturation );

		$dark-color : get-primary-dark-color( $theme: $theme );
		$light-color: get-primary-light-color( $theme: $theme );

		background-color: $background-color;
		color: contrast-color( 
			$background-color, 
			$dark-color, 
			$light-color, 
			lightness( mix( $dark-color, $light-color ) )
		);

		&.#{ $class-darker } {
			background-color: $darker-background-color;
			color: contrast-color( 
				$darker-background-color, 
				$dark-color, 
				$light-color, 
				lightness( mix( $dark-color, $light-color ) )
			);
		}

		&.#{ $class-much-darker } {
			background-color: $much-darker-background-color;
			color: contrast-color( 
				$much-darker-background-color, 
				$dark-color, 
				$light-color, 
				lightness( mix( $dark-color, $light-color ) )
			);
		}

		&.#{ $class-lighter } {
			background-color: $lighter-background-color;
			color: contrast-color( 
				$lighter-background-color, 
				$dark-color, 
				$light-color, 
				lightness( mix( $dark-color, $light-color ) )
			);
		}

		&.#{ $class-much-lighter } {
			background-color: $much-lighter-background-color;
			color: contrast-color( 
				$much-lighter-background-color, 
				$dark-color, 
				$light-color, 
				lightness( mix( $dark-color, $light-color ) )
			);
		}

		&.#{ $class-desaturated } {
			background-color: $desaturated-background-color;
			color: contrast-color( 
				$desaturated-background-color, 
				$dark-color, 
				$light-color, 
				lightness( mix( $dark-color, $light-color ) )
			);
		}

		&.#{ $class-alternate } {
			$dark-color : get-secondary-dark-color( $theme: $theme );
			$light-color: get-secondary-light-color( $theme: $theme );

			color: contrast-color( 
				$background-color, 
				$dark-color, 
				$light-color, 
				lightness( mix( $dark-color, $light-color ) )
			);
			&.#{ $class-darker } {
				color: contrast-color( 
					$darker-background-color, 
					$dark-color, 
					$light-color, 
					lightness( mix( $dark-color, $light-color ) )
				);
			}
		}
	}
}

@mixin button( 
	$theme                 : $current-theme,
	$inverse               : $current-inverse,
	$secondary             : $current-secondary,
	$lightening            : 10%,
	$darkening             : 5%,
	$extra-background-image: false
) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$hovered-theme : lighten-colors-by(    $theme, $lightening           );
		$active-theme  : darken-colors-by(     $theme, $darkening            );
		$inactive-theme: desaturate-colors-by( $theme, $default-desaturation );

		@extend .#{ $class-transitions } !optional;
		@include when-just-touching {
			@extend .#{ $class-transitions }.#{ $class-fast } !optional;
		}

		@include button-shadow ( $theme: $theme );
		@include button-shading( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $extra-background-image: $extra-background-image );

		@include when-at {
			@include button-shadow ( $theme: $hovered-theme, $hovered: true );
			@include button-shading( $theme: $hovered-theme, $inverse: $inverse, $secondary: $secondary, $extra-background-image: $extra-background-image );
		}
		@include when-active {
			@include button-shadow ( $theme: $active-theme, $depressed: true );
			@include button-shading( $theme: $active-theme, $inverse: $inverse, $secondary: $secondary, $extra-background-image: $extra-background-image );
		}
		@include when-disabled {
			@include whenever {
				@include button-shadow ( $theme: $inactive-theme, $disabled: true );
				@include button-shading( $theme: $inactive-theme, $inverse: $inverse, $secondary: $secondary, $extra-background-image: $extra-background-image );
			}
		}
	}
}

@mixin shallow-button( 
	$theme                 : $current-theme,
	$inverse               : $current-inverse,
	$secondary             : $current-secondary,
	$lightening            : 10%,
	$darkening             : 5%,
	$extra-background-image: false
) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$hovered-theme : lighten-colors-by(    $theme, $lightening           );
		$active-theme  : darken-colors-by(     $theme, $darkening            );
		$inactive-theme: desaturate-colors-by( $theme, $default-desaturation );

		@extend .#{ $class-transitions } !optional;
		@include when-just-touching {
			@extend .#{ $class-transitions }.#{ $class-fast } !optional;
		}

		@include button-shadow ( $theme: $theme );
		@include coloring( $theme: $theme, $inverse: $inverse, $secondary: $secondary );

		@include when-at {
			@include button-shadow ( $theme: $hovered-theme, $hovered: true );
			@include coloring( $theme: $hovered-theme, $inverse: $inverse, $secondary: $secondary );
		}
		@include when-active {
			@include button-shadow ( $theme: $active-theme, $depressed: true );
			@include coloring( $theme: $active-theme, $inverse: $inverse, $secondary: $secondary );
		}
		@include when-disabled {
			@include whenever {
				@include button-shadow ( $theme: $inactive-theme, $disabled: true );
				@include coloring( $theme: $inactive-theme, $inverse: $inverse, $secondary: $secondary );
			}
		}
	}
}

// By default, a flat button takes the background/light color of the set when neither hovered nor active, and when hovered is lightened by the given
// lightening and outer-shadowed, and when active is darkened and inset-shadowed; when inversed, the button takes the foreground/dark color of the set
// and otherwise has the same styling behavior.
@mixin flat-button(
	$theme     : $current-theme, 
	$inverse   : $current-inverse,
	$secondary : $current-secondary,
	$darkening : 10%, 
	$lightening: 5%
) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$hovered-theme : lighten-colors-by(    $theme, $lightening           );
		$active-theme  : darken-colors-by(     $theme, $darkening            );
		$inactive-theme: desaturate-colors-by( $theme, $default-desaturation );

		@include coloring( $theme: $theme, $inverse: $inverse, $secondary: $secondary );

		@extend .#{ $class-transitions } !optional;
		@include when-just-touching { // Only speed up the transitions when the user is actually touching the element - not when just the $class-active is applied...
			@extend .#{ $class-transitions }.#{ $class-fast } !optional;
		}

		@include shadow( $theme: $theme, $primary-depth-factor: 0 );
		@include when-at {
			@include coloring( $theme: $hovered-theme, $inverse: $inverse, $secondary: $secondary );
			@include shadow  ( $theme: $hovered-theme );
		}
		@include when-active {
			@include coloring( $theme: $active-theme, $inverse: $inverse, $secondary: $secondary );
			@include shadow  ( $theme: $active-theme, $external: false );
		}
		@include when-disabled {
			@include whenever {
				@include coloring( $theme: $inactive-theme, $inverse: $inverse, $secondary: $secondary );
				@include shadow  ( $theme: $inactive-theme, $primary-depth-factor: 0 );
			}
		}
	}
}

@mixin hybrid-button(
	$theme     : $current-theme, 
	$inverse   : $current-inverse,
	$secondary : $current-secondary,
	$darkening : 10%, 
	$lightening: 5%,
	$extra-background-image: false

) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$hovered-theme : lighten-colors-by(    $theme, $lightening           );
		$active-theme  : darken-colors-by(     $theme, $darkening            );
		$inactive-theme: desaturate-colors-by( $theme, $default-desaturation );

		@include button-shading( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $shading-opacity: 0, $extra-background-image: $extra-background-image );

		@extend .#{ $class-transitions } !optional;
		@include when-just-touching { // Only speed up the transitions when the user is actually touching the element - not when just the $class-active is applied...
			@extend .#{ $class-transitions }.#{ $class-fast } !optional;
		}

		@include shadow( $theme: $theme, $primary-depth-factor: 0 );
		@include when-at {
			@include button-shadow ( $theme: $hovered-theme, $hovered: true );
			@include button-shading( $theme: $hovered-theme, $inverse: $inverse, $secondary: $secondary, $extra-background-image: $extra-background-image );
		}
		@include when-active {
			@include button-shadow ( $theme: $active-theme, $depressed: true );
			@include button-shading( $theme: $active-theme, $inverse: $inverse, $secondary: $secondary, $extra-background-image: $extra-background-image );
		}
		@include when-disabled {
			@include whenever {
				@include no-shadow;
				@include button-shading( $theme: $theme, $inverse: $inverse, $secondary: $secondary, $shading-opacity: 0, $extra-background-image: $extra-background-image );
				@include coloring      ( $theme: $inactive-theme, $inverse: $inverse, $secondary: $secondary );
			}
		}
	}
}


@mixin button-shading(
	$theme                 : $current-theme, 
	$inverse               : $current-inverse,
	$secondary             : $current-secondary,
	$shading-opacity       : .2, 
	$extra-background-image: false
) {
	@if has-primary( $theme: $theme ) and has-secondary( $theme: $theme ) {
		$background-color: get-color( $theme: $theme, $inverse: $inverse, $secondary: $secondary );

		$lightening: $shading-opacity;
		$darkening: $shading-opacity / 2;

		$background-color-stops       : color-stops( rgba( white, $lightening ),  rgba( black, $darkening ) );

		$dark-color : get-primary-dark-color(  $theme: $theme );
		$light-color: get-primary-light-color( $theme: $theme );

		color: contrast-color( 
			$background-color, 
			$dark-color, 
			$light-color, 
			lightness( mix( $dark-color, $light-color ) )
		);
		background-color: $background-color;
		@if $extra-background-image == false {
			@include background-image( linear-gradient( top, $background-color-stops ) );
		}
		@else {
			@include background-image( linear-gradient( top, $background-color-stops ), $extra-background-image );
		}
	}
}
